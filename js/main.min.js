$(function(){"use strict";function i(){var t=new $.RestClient("/steam-weeklong-deals/api/");n=t.add("sale"),e=t.add("details",{isSingle:!0}),e.add("app"),e.add("sub")}function d(t){var n=t.indexOf("?"),e=t.substring(0,-1!==n?n:t.length);return e.lastIndexOf("/")===e.length-1&&(e=e.substring(0,e.lastIndexOf("/"))),e}function l(t,n){return $("<a>",{href:t,text:n,target:"_blank"}).wrapAll("<div>").parent().html()}function s(n,i){var s=$(i),o=d(s.find("a").attr("href")),r=o.lastIndexOf("/"),f=o.substring(r+1),u=l(o,f),c=s.find(".info .percent").first().text(),h=s.find(".info .price span.was").first().text(),p=s.find(".info .price span").last().text(),g=o.substring(r-3,r);e[g].read(f).done(function(n){var e=$(n.html).find("h4").first().text();a.push([u,e,c,h,p,""]),$("#load-count").html("Loaded "+a.length+" of "+t.length+" entries...")})}function o(){n.read("weeklongdeals").done(function(n){t=$(n.html).find(".item"),t.each(s)})}function r(){$(document).ajaxStop(function(){$("#ajax-loader").hide(),$("#deals-table").dataTable({data:a,columns:[{title:"App ID"},{title:"Name"},{title:"Discount"},{title:"Was"},{title:"Now"},{title:"Rating*"}]}),$(".show-on-load").removeClass("hidden")})}function f(){i(),o(),r()}var t,n,e,a=[];f()});